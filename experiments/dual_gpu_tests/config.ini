# 双A100 GPU性能测试配置文件
# 用户可以根据需要修改这些参数

# 基本配置
[basic]
# 输出目录
output_dir = "results"

# 测试模型列表
models = [
    "facebook/opt-125m",     # 小模型，用于基础测试
    "facebook/opt-1.3b",     # 中等模型，用于并行测试
    # "facebook/opt-2.7b",   # 大模型，如果有足够内存
]

# GPU配置
[gpu]
# 最大Tensor Parallel大小
max_tp_size = 2

# 最大Pipeline Parallel大小
max_pp_size = 2

# GPU内存利用率
gpu_memory_utilization = 0.8

# 测试参数
[test_params]
# 序列长度列表
sequence_lengths = [128, 256, 512, 1024, 2048, 4096]

# 批次大小列表
batch_sizes = [1, 2, 4, 8, 16, 32]

# 测试重复次数
num_samples = 5

# 预热次数
num_warmup = 2

# 带宽测试配置
[bandwidth_test]
# 测试数据大小 (MB)
test_sizes = [1, 4, 16, 64, 256, 1024]

# 测试迭代次数
iterations = 100

# 预热迭代次数
warmup_iterations = 10

# 序列长度测试配置
[sequence_test]
# 最小序列长度
min_length = 100

# 最大序列长度
max_length = 4096

# 测试步数
steps = 12

# PP测试配置
[pp_test]
# 测试的序列长度
test_sequence_lengths = [256, 512, 1024, 2048]

# 测试的批次大小
test_batch_sizes = [1, 2, 4, 8]

# 是否测试流水线气泡
test_pipeline_bubble = true

# TP测试配置
[tp_test]
# 测试的序列长度
test_sequence_lengths = [256, 512, 1024, 2048]

# 测试的批次大小
test_batch_sizes = [1, 2, 4, 8]

# 通信测试张量大小
comm_tensor_sizes = [
    [1, 4096],
    [32, 4096],
    [128, 4096],
    [1, 4096, 4096],
    [32, 2048, 4096]
]

# 快速测试配置（用于调试和快速验证）
[quick_test]
models = ["facebook/opt-125m"]
sequence_lengths = [256, 512]
batch_sizes = [1, 4]
max_tp_size = 2
max_pp_size = 2
num_samples = 3

# 高级配置
[advanced]
# 是否启用详细日志
verbose_logging = true

# 是否保存中间结果
save_intermediate = true

# 是否生成可视化图表
generate_plots = true

# 是否进行统计显著性检验
statistical_testing = false

# 超时设置（秒）
test_timeout = 1800  # 30分钟

# 内存监控间隔（秒）
memory_monitor_interval = 1.0

# 报告配置
[reporting]
# 报告格式
formats = ["json", "markdown", "html"]

# 是否包含原始数据
include_raw_data = true

# 是否生成性能对比图
generate_comparison_charts = true

# 图表DPI
chart_dpi = 300

# 环境检测
[environment]
# 最低CUDA版本要求
min_cuda_version = "11.0"

# 最低PyTorch版本要求
min_pytorch_version = "1.12.0"

# 是否检查GPU温度
monitor_temperature = true

# GPU温度阈值（摄氏度）
max_temperature = 85
